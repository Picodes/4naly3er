Feel free to open PRs or open issues within this repository.

To add an issue to the analyzer, you have 2 choices:

- use a detector based on a simple regex
- use a detector based on the analysis of the Abstract Syntax Tree generated by the `solc` compiler

### Regex-based detector:

Examples:

- [Cache Array Length](src/issues/GAS/cacheArrayLength.ts)
- [Custom Errors](src/issues/GAS/customErrors.ts)

Following this type, just add a file in the `issues/<X>` folder:

```js
type RegexIssue = {
  type: IssueTypes.GAS | IssueTypes.NC | IssueTypes.L | IssueTypes.M | IssueTypes.H,
  regex: RegExp,
  title: string,
  impact?: string,
  description?: string,
  regexOrAST: 'Regex',
};
```

### AST-based detector:

Examples:

- [Use Assembly when querying balances](src/issues/GAS/addressBalance.ts)
- [Use Assembly to check `address != 0`](src/issues/GAS/addressZero.ts)

Following this type, just add a file in the `issues/<X>` folder:

```js
type ASTIssue = {
  type: IssueTypes.GAS | IssueTypes.NC | IssueTypes.L | IssueTypes.M | IssueTypes.H,
  title: string,
  impact?: string,
  description?: string,
  detector: (files: InputType) => Instance[], // Function analyzing the AST and returning instances of the issue
  regexOrAST: 'AST',
};
```


